apiVersion: ai.sap.com/v1alpha1
kind: ServingTemplate
metadata:
  name: sarimax-forecasting-server
  annotations:
    scenarios.ai.sap.com/description: "SARIMAX Time Series Forecasting for City Gas-CNG Demand"
    scenarios.ai.sap.com/name: "SARIMAX Forecasting"
    executables.ai.sap.com/description: "Expanding Window SARIMAX Model Server"
    executables.ai.sap.com/name: "sarimax-server"
  labels:
    scenarios.ai.sap.com/id: "sarimax-timeseries"
    executables.ai.sap.com/id: "sarimax-server"
    ai.sap.com/version: "1.0.0"
spec:
  inputs:
    parameters:
      - name: modelName
        type: string
        default: "sarimax_initial_18months"
      - name: imageName
        type: string
        default: "docker.io/priyaannamalai/sarimax-forecasting:v1"
  template:
    apiVersion: "serving.kserve.io/v1beta1"
    kind: "InferenceService"
    metadata:
      name: "{{workflow.name}}"
      labels:
        ai.sap.com/resourcePlan: "starter"
    spec:
      predictor:
        minReplicas: 1
        maxReplicas: 3
        containers:
          - name: "kserve-container"
            image: "{{inputs.parameters.imageName}}"
            ports:
              - containerPort: 9001
                protocol: "TCP"
            env:
              - name: "MODEL_PATH"
                value: "/app/models"
              - name: "PORT"
                value: "9001"
              - name: "MODEL_NAME"
                value: "{{inputs.parameters.modelName}}"
